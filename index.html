<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Aggro PvP â€” JOIN THE FIGHT</title>
  <style>
    :root{
      --bg:#050505;
      --red:#ff1a1a;
      --cycle:4000;
      --text-dur:3000;
      --flash-dur:600;
      --circle-dur:3000;
      --z-menu:6000; --z-vfx:4500; --z-blood:3500;
      --z-head:3000; --z-color:2500; --z-smoke:2000;
      --z-cta:1000; --z-logo:1000;
      --cta-height:56px;
      --cta-radius:12px;
    }

    *,*::before,*::after{box-sizing:border-box}
    html,body{height:100%;width:100%;margin:0;padding:0;background:var(--bg);overflow:hidden;color:#fff;font-family:"28Days",sans-serif}
    @font-face{font-family:"28Days";src:url("28%20Days%20Later.ttf") format("truetype");font-display:swap}
    button,a{background:none;border:none;cursor:pointer;font-family:inherit;text-decoration:none;color:inherit}

    /* MENU */
    .anarchyBtn{position:fixed;top:14px;right:14px;z-index:var(--z-menu);pointer-events:auto}
    .anarchyBtn img{width:64px;height:64px;display:block}
    .anarchyMenu{position:fixed;top:90px;right:14px;display:none;flex-direction:column;padding:12px;background:rgba(10,10,10,0.95);border-radius:12px;z-index:var(--z-menu);pointer-events:auto}
    .anarchyMenu.open{display:flex}
    .anarchyMenu a{color:#ffdede;font-size:16px;font-weight:800;padding:10px 14px}

    /* LOGO / CTA placement */
    #logo{position:fixed;top:6vh;left:50%;transform:translateX(-50%);z-index:var(--z-logo);pointer-events:auto}
    #logo img{max-width:30vw;height:auto;display:block}
    .cta{position:fixed;bottom:8vh;left:50%;transform:translateX(-50%);display:flex;gap:18px;z-index:var(--z-cta);pointer-events:auto}

    /* 3D CTA buttons */
    .cta .btn {
      --base:#0b0b0b;
      --edge:#060606;
      --highlight:linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.01));
      display:inline-flex;align-items:center;gap:12px;justify-content:center;
      height:var(--cta-height);min-width:220px;padding:0 22px;border-radius:var(--cta-radius);
      background:linear-gradient(180deg,var(--base),var(--edge));color:#fff;font-weight:900;letter-spacing:.06em;
      box-shadow:0 12px 30px rgba(0,0,0,0.8), 0 2px 0 rgba(0,0,0,0.6) inset;
      transform:translateZ(0);transition:transform .18s cubic-bezier(.2,.9,.3,1),box-shadow .18s;
      position:relative;overflow:visible;border:2px solid rgba(255,255,255,0.03);
    }

    /* small bevel highlight */
    .btn::before{
      content:"";position:absolute;inset:2px;border-radius:calc(var(--cta-radius) - 2px);
      background:var(--highlight);mix-blend-mode:overlay;pointer-events:none;
      opacity:.35;
    }

    /* icon style */
    .btn .icon{
      width:28px;height:28px;display:inline-block;flex:0 0 28px;
    }

    /* Steam variant */
    .btn.steam{ background:linear-gradient(180deg,#111,#050505); border-color:rgba(255,255,255,0.04) }
    .btn.steam .badge{ background:linear-gradient(180deg,#ff6b6b,#ff2a2a); padding:4px 8px;border-radius:8px;font-size:12px;font-weight:800 }

    /* Discord variant */
    .btn.discord{ background:linear-gradient(180deg,#23263a,#0f1220); border-color:rgba(255,255,255,0.03) }
    .btn.discord .badge{ background:linear-gradient(180deg,#7289da,#4962c8); padding:4px 8px;border-radius:8px;font-size:12px;font-weight:800 }

    /* hover / focus / active states */
    .btn:hover{ transform:translateY(-6px) scale(1.01); box-shadow:0 20px 40px rgba(0,0,0,0.75) }
    .btn:active{ transform:translateY(-2px) scale(.995); box-shadow:0 6px 18px rgba(0,0,0,0.85) }
    .btn:focus{ outline:3px solid rgba(255,255,255,0.06); outline-offset:4px }

    /* smaller screens: stack */
    @media (max-width:620px){
      .cta{flex-direction:column;gap:12px;bottom:6vh}
      .btn{min-width:220px;width:88vw}
      #logo img{max-width:60vw}
    }

    /* SMOKE VIDEO */
    #smoke-wrap{position:fixed;inset:0;pointer-events:none;z-index:var(--z-smoke)}
    #smokeVideo{width:100%;height:100%;object-fit:cover;opacity:.6;transition:filter .35s linear}
    /* fallback when using filter tint (applied to body.use-filter) */
    body.use-filter #smokeVideo{ filter: brightness(.8) saturate(1.15) contrast(1.05) }
    body.use-filter #smokeVideo.tinted{ filter: brightness(.6) saturate(1.4) contrast(1.05) sepia(.18) hue-rotate(-10deg) saturate(1.7) }

    /* COLOR OVERLAY (desktop / non-problematic) */
    #colorOverlay{
      position:fixed;inset:0;background:var(--red);mix-blend-mode:color;opacity:0;transition:opacity var(--text-dur)ms ease-in-out;z-index:var(--z-color);pointer-events:none
    }

    /* RED FLASH (keeps original) */
    #redOverlay{position:fixed;inset:0;background:var(--red);mix-blend-mode:screen;opacity:0;z-index:var(--z-vfx);pointer-events:none;animation-fill-mode:both}
    @keyframes redFlash{0%{opacity:0}10%{opacity:.4}30%{opacity:0}100%{opacity:0}}

    /* VFX flicker placeholder */
    .vfx{position:fixed;inset:0;pointer-events:none;z-index:var(--z-vfx)}
    .vfx .flicker{position:absolute;inset:0;mix-blend-mode:screen;opacity:0}

    /* HEADLINE */
    #headline{position:fixed;top:42vh;left:50%;transform:translateX(-50%);text-align:center;z-index:var(--z-head);pointer-events:none}
    #headlineText{font-size:clamp(48px,14vw,136px);line-height:.9;letter-spacing:.12em;opacity:0;will-change:opacity}
    @keyframes textFade{0%,10%{opacity:0}20%,80%{opacity:1}100%{opacity:0}}
    .fadeText{animation:textFade var(--text-dur)ms both}
    @keyframes glitch{0%,100%{clip:rect(0,9999px,0,0)}20%{clip:rect(20px,9999px,40px,0)}40%{clip:rect(50px,9999px,70px,0)}60%{clip:rect(10px,9999px,30px,0)}80%{clip:rect(60px,9999px,80px,0)}}
    .glitch,.glitch::before,.glitch::after{animation:glitch .6s steps(2) both}
    .glitch::before,.glitch::after{content:attr(data-text);position:absolute;inset:0;mix-blend-mode:screen;opacity:.6}
    .glitch::before{color:#ff4b4b;left:2px}
    .glitch::after{color:#7fb7ff;left:-2px}

    /* BLOOD CIRCLE */
    #bloodCircle{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) scale(1);opacity:0;width:clamp(200px,40vw,400px);pointer-events:none;z-index:var(--z-blood);animation-fill-mode:both}
    @keyframes circleAnim{0%,20%{opacity:0}25%,75%{opacity:.6}100%{opacity:0}}

    /* accessibility: reduced motion */
    @media (prefers-reduced-motion:reduce){
      *{animation-duration:0.001ms !important; transition:none !important}
      .btn:hover,.btn:active{transform:none;box-shadow:none}
    }
  </style>
</head>
<body>

  <!-- menu -->
  <button id="anarchyBtn" class="anarchyBtn" aria-controls="anarchyMenu" aria-expanded="false">
    <img src="anarchy.png" alt="Toggle menu"/>
  </button>
  <nav id="anarchyMenu" class="anarchyMenu" role="menu">
    <a href="rules.html">Rules</a>
    <a href="support.html">Support</a>
    <a href="donate.html">Donate</a>
    <a href="killfeed.html">Kill Feed</a>
    <a href="leaderboard.html">Leaderboard</a>
  </nav>

  <!-- CTA & logo -->
  <div class="cta" role="navigation" aria-label="Primary actions">
    <!-- Steam button: uses steam:// protocol but also safe fallback -->
    <a class="btn steam" id="steamBtn" href="steam://connect/YOURSERVERIP" role="button" aria-label="Join server on Steam">
      <!-- inline SVG steam icon (small, simple) -->
      <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg">
        <circle cx="6.5" cy="13.5" r="2.4" fill="#fff" opacity="0.9"/>
        <circle cx="16.5" cy="7.5" r="2.4" fill="#fff" opacity="0.9"/>
        <path d="M7.9 12.3l6.2-3.6" stroke="#fff" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" opacity="0.95"/>
        <path d="M10.9 15.1l4.9-2.9" stroke="#fff" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" opacity="0.95"/>
      </svg>
      <span style="font-size:15px">JOIN SERVER</span>
      <span class="badge" aria-hidden="true" style="margin-left:8px;background:#ff4b4b;color:#fff;border-radius:8px;padding:6px 10px;font-size:12px;font-weight:900">LIVE</span>
    </a>

    <!-- Discord button: opens link -->
    <a class="btn discord" id="discordBtn" href="https://discord.gg/YOURDISCORD" role="button" aria-label="Join our Discord">
      <!-- inline Discord glyph -->
      <svg class="icon" viewBox="0 0 71 55" fill="none" aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg">
        <path d="M20 20c2.2 0 4 1.8 4 4s-1.8 4-4 4-4-1.8-4-4 1.8-4 4-4zM51 20c2.2 0 4 1.8 4 4s-1.8 4-4 4-4-1.8-4-4 1.8-4 4-4z" fill="#fff"/>
      </svg>
      <span style="font-size:15px">JOIN COMMUNITY</span>
      <span class="badge" aria-hidden="true" style="margin-left:8px;background:linear-gradient(180deg,#5b8df0,#344eaf);color:#fff;border-radius:8px;padding:6px 10px;font-size:12px;font-weight:900">CHAT</span>
    </a>
  </div>

  <div id="logo"><img src="Aggro-logo.PNG" alt="Aggro Logo"/></div>

  <!-- smoke -->
  <div id="smoke-wrap">
    <video id="smokeVideo" muted autoplay loop playsinline preload="auto">
      <source src="Smoke.mp4" type="video/mp4"/>
    </video>
  </div>

  <!-- overlays -->
  <div id="colorOverlay" aria-hidden="true"></div>
  <div id="redOverlay" aria-hidden="true"></div>
  <div class="vfx"><div id="vfxFlicker" class="flicker" aria-hidden="true"></div></div>

  <!-- headline & blood -->
  <div id="headline">
    <div id="headlineText" class="fadeText" data-text="JOIN THE FIGHT">JOIN THE FIGHT</div>
    <img id="bloodCircle" src="blood1.png" alt="Blood circle"/>
  </div>

  <script>
  (function(){
    const S = getComputedStyle(document.documentElement);
    const cycle = +S.getPropertyValue('--cycle') || 4000;
    const txtDur = +S.getPropertyValue('--text-dur') || 3000;
    const flash = +S.getPropertyValue('--flash-dur') || 600;

    const colorOvl = document.getElementById('colorOverlay');
    const redOvl = document.getElementById('redOverlay');
    const textEl = document.getElementById('headlineText');
    const circle = document.getElementById('bloodCircle');
    const flicker = document.getElementById('vfxFlicker');
    const smoke = document.getElementById('smokeVideo');
    let running = false;

    /* Utility to restart CSS animation */
    function restart(el,name,dur,delay=0){
      el.style.animation = 'none';
      void el.offsetWidth;
      el.style.animation = `${name} ${dur}ms ${delay}ms both`;
    }

    /* Detect iPad / iOS WebKit where mix-blend-mode color/screen can produce bad results.
       We use a conservative sniff: iPad (navigator.platform) or iOS with touch and WebKit.
       If detected, body.use-filter gets added and we'll tint the video via filter rather than overlay mix-blend-mode.
    */
    function detectiPadLike(){
      const ua = navigator.userAgent || navigator.vendor || '';
      const isIpad = /iPad/.test(ua);
      const isIOS = /iPhone|iPod/.test(ua);
      // newer iPadOS may present as Mac, so detect touch + maxTouchPoints
      const isTouch = ('ontouchstart' in window) || navigator.maxTouchPoints > 1;
      const isSafari = /AppleWebKit/.test(ua) && !/CriOS|FxiOS|OPiOS/.test(ua);
      return (isIpad || (isIOS || (isTouch && isSafari)));
    }

    /* If iPad-like detected, use filter tint approach to avoid mix-blend artifacts */
    function setupTintMode(){
      if(detectiPadLike()){
        document.body.classList.add('use-filter');
      }
    }

    function applyTintOnVideo(on){
      // when on==true we apply an additional tinted class to the video to make it redder,
      // we also avoid using colorOverlay mix-blend by keeping its opacity at 0 on these devices
      if(document.body.classList.contains('use-filter')){
        if(on){
          smoke.classList.add('tinted');
          colorOvl.style.opacity = '0';
        } else {
          smoke.classList.remove('tinted');
        }
      } else {
        // non-problem devices: use original color overlay
        if(on) colorOvl.style.opacity = '1';
        else colorOvl.style.opacity = '0';
      }
    }

    function run(){
      if(running) return;
      running = true;

      // 1) colorBlend tint or video filter
      applyTintOnVideo(true);
      setTimeout(()=> applyTintOnVideo(false), txtDur);

      // 2) red flash (keeps original approach)
      restart(redOvl,'redFlash',flash);

      // 3) text fade + glitch
      restart(textEl,'textFade',txtDur);
      textEl.classList.remove('glitch');
      setTimeout(()=> textEl.classList.add('glitch'),200);

      // 4) blood fade
      restart(circle,'circleAnim', +S.getPropertyValue('--circle-dur'), +S.getPropertyValue('--circle-delay'));

      // 5) flicker (brief)
      flicker.style.opacity = '1';
      setTimeout(()=> flicker.style.opacity = '0', flash);

      setTimeout(()=> running = false, cycle);
    }

    /* Menu toggle */
    document.getElementById('anarchyBtn').addEventListener('click', e=>{
      e.stopPropagation();
      const menu = document.getElementById('anarchyMenu');
      const open = menu.classList.toggle('open');
      e.currentTarget.setAttribute('aria-expanded', open);
    });
    document.addEventListener('click', e=>{
      if(!e.target.closest('.anarchyBtn') && !e.target.closest('.anarchyMenu')){
        document.getElementById('anarchyMenu').classList.remove('open');
        document.getElementById('anarchyBtn').setAttribute('aria-expanded', false);
      }
    });

    /* Steam fallback: if steam:// fails on this platform, open a fallback link after short delay.
       We attach click handler to attempt steam protocol, then fallback to a safe web link.
    */
    const steamBtn = document.getElementById('steamBtn');
    if(steamBtn){
      steamBtn.addEventListener('click', function(e){
        // keep default behavior, but also provide a safe fallback for browsers that block steam://
        const fallback = 'https://store.steampowered.com/'; // replace with server landing if you have one
        // Attempt to open steam protocol, but if not possible user stays on page; no heavy logic to avoid async issues.
        setTimeout(()=> {
          // If user agent is mobile where steam protocol is often blocked, open fallback in new tab
          if(/Mobi|Android|iPhone|iPad|iPod/.test(navigator.userAgent)) {
            window.open(fallback, '_blank');
          }
        }, 800);
      });
    }

    window.addEventListener('DOMContentLoaded', ()=>{
      setupTintMode();
      // ensure video visibility; some mobile browsers require re-play
      if(smoke && smoke.paused){
        smoke.play().catch(()=>{/* ignore autoplay block */});
      }
      run();
      setInterval(run, cycle);
    });
  })();
  </script>
</body>
</html>
